# Техническое задание: Система бронирования авиабилетов

**Студент:** Передереев Артём Владимирович

**Группа:** 2307В1

---

## 1. Описание проекта

### 1.1 Название системы
"Система онлайн-бронирования и покупки авиабилетов"

### 1.2 Назначение
Система предназначена для поиска, бронирования и покупки авиабилетов. Позволяет пользователям находить рейсы по заданным параметрам, выбирать места в салоне, оформлять заказы и производить оплату банковской картой.

---

## 2. Функциональные требования

### 2.1 Основные функции системы

#### Функция 1: Поиск рейсов
- **Описание:** Пользователь вводит параметры поиска: города вылета и прилёта, даты. Система находит подходящие рейсы с указанием времени, авиакомпании, цены и доступности.
- **Входные данные:** Город вылета, город прилёта, дата вылета
- **Результат:** Список найденных рейсов с основной информацией

#### Функция 2: Просмотр деталей рейса
- **Описание:** Отображение подробной информации о выбранном рейсе: расписание, тип самолёта, классы обслуживания, багажные нормы, условия тарифа.
- **Входные данные:** Выбранный рейс из списка
- **Результат:** Детальная информация о рейсе и доступных местах

#### Функция 3: Выбор места в салоне
- **Описание:** После выбора рейса пользователь может выбрать конкретное место в салоне самолёта на схеме рассадки.
- **Входные данные:** Выбранный рейс, предпочтения по расположению (у окна, у прохода и т.д.)
- **Результат:** Выбранное место закреплено за бронированием

#### Функция 4: Бронирование билета
- **Описание:** Пользователь вводит данные пассажиров (ФИО, дата рождения, контактная информация) и подтверждает бронирование. Система резервирует места на определённое время.
- **Входные данные:** Данные пассажиров, контактная информация
- **Результат:** Забронированный билет с уникальным номером брони

#### Функция 5: Оплата билета
- **Описание:** Пользователь оплачивает забронированный билет банковской картой. Система проверяет корректность данных карты, обрабатывает платёж и подтверждает покупку.
- **Входные данные:** Данные банковской карты (номер, срок действия, CVV), email для отправки чека
- **Результат:** Оплаченный билет с электронным билетом, отправленным на email

#### Функция 6: Управление бронированиями
- **Описание:** Пользователь может просматривать свои текущие и завершённые бронирования, отменять неоплаченные брони, повторно отправлять электронные билеты.
- **Входные данные:** Номер бронирования или email
- **Результат:** Список бронирований пользователя

#### Функция 7: Поиск и фильтрация авиакомпаний
- **Описание:** Пользователь может фильтровать рейсы по авиакомпаниям, времени вылета, цене, длительности перелёта.
- **Входные данные:** Критерии фильтрации
- **Результат:** Отфильтрованный список рейсов

---

## 3. Структура базы данных

### Таблица 1: Airlines (Авиакомпании)

**Описание:** Хранит информацию об авиакомпаниях

**Поля:**
- `Id` (int, PK) — уникальный идентификатор авиакомпании
- `Name` (string) — название авиакомпании
- `Code` (string) — код авиакомпании (IATA)
- `ContactPhone` (string) — контактный телефон
- `Website` (string) — веб-сайт

**Связи:**
- Связь один-ко-многим с таблицей `Flights` (одна авиакомпания может иметь много рейсов)

### Таблица 2: Cities (Города)

**Описание:** Хранит информацию о городах

**Поля:**
- `Id` (int, PK) — уникальный идентификатор города
- `Name` (string) — название города
- `Country` (string) — страна
- `AirportCode` (string) — код аэропорта (IATA)
- `AirportName` (string) — название аэропорта

**Связи:**
- Связь один-ко-многим с таблицей `Flights` (один город может быть городом вылета для многих рейсов)
- Связь один-ко-многим с таблицей `Flights` (один город может быть городом прилёта для многих рейсов)

### Таблица 3: Flights (Рейсы)

**Описание:** Хранит информацию о рейсах

**Поля:**
- `Id` (int, PK) — уникальный идентификатор рейса
- `FlightNumber` (string) — номер рейса
- `AirlineId` (int, FK → Airlines.Id) — авиакомпания
- `DepartureCityId` (int, FK → Cities.Id) — город вылета
- `ArrivalCityId` (int, FK → Cities.Id) — город прилёта
- `DepartureDateTime` (DateTime) — дата и время вылета
- `ArrivalDateTime` (DateTime) — дата и время прилёта
- `AircraftType` (string) — тип самолёта
- `TotalSeats` (int) — общее количество мест
- `AvailableSeats` (int) — количество доступных мест
- `BasePrice` (decimal) — базовая цена билета

**Связи:**
- `AirlineId` → Airlines.Id
- `DepartureCityId` → Cities.Id
- `ArrivalCityId` → Cities.Id
- Связь один-ко-многим с таблицей `Bookings` (один рейс может иметь много бронирований)
- Связь один-ко-многим с таблицей `Seats` (один рейс имеет много мест)

### Таблица 4: Seats (Места)

**Описание:** Хранит информацию о местах в самолёте

**Поля:**
- `Id` (int, PK) — уникальный идентификатор места
- `FlightId` (int, FK → Flights.Id) — рейс
- `SeatNumber` (string) — номер места
- `Class` (string) — класс обслуживания
- `IsAvailable` (bool) — доступно ли место
- `PriceMultiplier` (decimal) — коэффициент цены

**Связи:**
- `FlightId` → Flights.Id

### Таблица 5: Bookings (Бронирования)

**Описание:** Хранит информацию о бронированиях билетов

**Поля:**
- `Id` (int, PK) — уникальный идентификатор бронирования
- `BookingReference` (string) — номер бронирования
- `FlightId` (int, FK → Flights.Id) — рейс
- `PassengerName` (string) — ФИО пассажира
- `PassengerEmail` (string) — email пассажира
- `PassengerPhone` (string) — телефон пассажира
- `PassengerBirthDate` (DateTime) — дата рождения пассажира
- `SeatNumber` (string) — номер места в салоне
- `BookingDate` (DateTime) — дата бронирования
- `Status` (string) — статус: "Забронирован", "Оплачен", "Отменён"
- `TotalPrice` (decimal) — общая стоимость
- `ExpiryDate` (DateTime) — дата истечения бронирования

**Связи:**
- `FlightId` → Flights.Id
- Связь один-к-одному с таблицей `Payments` (одно бронирование имеет один платёж)

### Таблица 6: Payments (Платежи)

**Описание:** Хранит информацию об оплатах

**Поля:**
- `Id` (int, PK) — уникальный идентификатор платежа
- `BookingId` (int, FK → Bookings.Id) — бронирование
- `PaymentDate` (DateTime) — дата и время платежа
- `Amount` (decimal) — сумма платежа
- `PaymentMethod` (string) — способ оплаты ("Карта")
- `CardLastFour` (string) — последние 4 цифры карты
- `TransactionId` (string) — идентификатор транзакции
- `Status` (string) — статус: "Успешно", "Ошибка"

**Связи:**
- `BookingId` → Bookings.Id

---

## 4. Основные формы приложения

#### Форма 1: MainWindow (Главная форма)

**Назначение:** Основная форма для поиска рейсов и управления бронированиями

**Элементы управления:**
- TabControl — вкладки "Поиск рейсов", "Мои бронирования"
- ComboBox (город вылета) — выбор города вылета из списка
- ComboBox (город прилёта) — выбор города прилёта из списка
- DatePicker (дата вылета) — выбор даты вылета
- DataGrid (список рейсов) — отображение найденных рейсов
- Button (поиск) — кнопка поиска рейсов
- TextBox (поиск email) — поле для поиска бронирований по email
- DataGrid (список бронирований) — отображение бронирований пользователя
- Button (найти бронирования) — поиск бронирований по email
- Button (обновить) — обновление списка бронирований

**Действия:**
- Кнопка "Найти рейсы" — поиск рейсов по заданным параметрам
- Кнопка "Найти бронирования" — поиск бронирований по email
- Кнопка "Обновить" — обновление списка бронирований
- Двойной клик по рейсу — открытие FlightDetailsWindow

#### Форма 2: FlightDetailsWindow (Детали рейса)

**Назначение:** Просмотр подробной информации о рейсе и выбор места

**Элементы управления:**
- TextBlock (информация о рейсе) — отображение деталей рейса
- TextBlock (маршрут) — информация о городах вылета и прилёта
- TextBlock (время) — информация о времени вылета и прилёта
- TextBlock (самолёт) — информация о типе самолёта и доступных местах
- DataGrid (доступные места) — список доступных мест с ценами
- Button (выбрать место) — выбор места для бронирования
- Button (назад) — возврат к поиску

**Действия:**
- Кнопка "Выбрать место" — переход к BookingWindow с выбранным местом
- Кнопка "Назад" — возврат на MainWindow

#### Форма 3: BookingWindow (Оформление бронирования)

**Назначение:** Ввод данных пассажира и подтверждение бронирования

**Элементы управления:**
- TextBox (ФИО пассажира) — ФИО пассажира
- TextBox (email) — email пассажира
- TextBox (телефон) — телефон пассажира
- DatePicker (дата рождения) — дата рождения пассажира
- TextBlock (информация о рейсе) — детали выбранного рейса
- TextBlock (информация о месте) — выбранное место и цена
- TextBlock (ошибки валидации) — отображение ошибок ввода
- Button (забронировать) — подтверждение бронирования
- Button (отмена) — отмена бронирования

**Действия:**
- Кнопка "Забронировать" — создание бронирования и переход к PaymentWindow
- Кнопка "Отмена" — возврат к деталям рейса

#### Форма 4: PaymentWindow (Форма оплаты)

**Назначение:** Оплата забронированного билета

**Элементы управления:**
- TextBlock (номер брони) — отображение номера бронирования
- TextBlock (сумма) — отображение суммы к оплате
- TextBox (номер карты) — ввод номера банковской карты
- TextBox (срок действия) — ввод срока действия карты (MM/YY)
- TextBox (CVV) — ввод кода безопасности
- TextBox (владелец карты) — имя владельца карты
- TextBlock (ошибки оплаты) — отображение ошибок при оплате
- Button (оплатить) — обработка платежа
- Button (отмена) — отмена оплаты

**Действия:**
- Кнопка "Оплатить" — обработка платежа и подтверждение покупки
- Кнопка "Отмена" — отмена оплаты, возврат к бронированию

#### Форма 5: MyBookingsWindow (Мои бронирования)

**Назначение:** Просмотр и управление бронированиями

**Элементы управления:**
- DataGrid (список бронирований) — отображение текущих и завершённых бронирований
- TextBox (поиск) — поиск бронирований по номеру или email
- Button (отменить) — отмена выбранного бронирования
- Button (повторить email) — повторная отправка электронного билета
- Button (обновить) — обновление списка бронирований

**Действия:**
- Кнопка "Отменить" — отмена выбранного бронирования
- Кнопка "Повторить email" — отправка билета на email
- Кнопка "Обновить" — обновление данных

---

## 5. Схема переходов между формами

### Схема навигации

#### При запуске приложения
**Запуск** → `MainWindow` (главная форма поиска рейсов)

#### Из MainWindow
**Вкладка "Поиск рейсов":**
- Выбор параметров → Кнопка "Найти рейсы" → отображение рейсов в DataGrid
- Двойной клик по рейсу в списке → `FlightDetailsWindow` (детали рейса)

**Вкладка "Мои бронирования":**
- Ввод email → Кнопка "Найти бронирования" → отображение бронирований
- Кнопка "Обновить" → обновление списка бронирований

#### Из FlightDetailsWindow
- Выбор места → Кнопка "Выбрать место" → `BookingWindow` (оформление бронирования)
- Кнопка "Назад" → возврат на `MainWindow`

#### Из BookingWindow
- Заполнение данных → Кнопка "Забронировать" → создание бронирования → `PaymentWindow` (оплата)
- Кнопка "Отмена" → возврат на `FlightDetailsWindow`

#### Из PaymentWindow
**Кнопка "Оплатить":**
- Успешная оплата → сообщение об успехе → возврат на `MainWindow`
- Неудачная оплата → сообщение об ошибке → остаёмся на `PaymentWindow`

**Кнопка "Отмена"** → возврат на `BookingWindow`

#### Из MyBookingsWindow
- Выбор бронирования → Кнопка "Отменить" → диалог подтверждения → отмена бронирования
- Кнопка "Повторить email" → отправка билета → сообщение об успехе
- Кнопка "Обновить" → обновление списка бронирований
- Закрытие окна → возврат на `MainWindow`
